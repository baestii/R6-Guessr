<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>R6 Map Guesser</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #1e1e2f;
      color: #f4f4f4;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
    }
    .container {
      text-align: center;
    }
    h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }
    p {
      font-size: 1.1rem;
      margin-bottom: 2rem;
    }
    button {
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      background-color: #4e8cff;
      color: white;
      border: none;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 1rem;
    }
    button:hover {
      background-color: #3a6edc;
    }
    #game {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
      height: 100%;
      width: 100%;
      position: relative;
      z-index: 1;
      transition: background-color 1s ease;
      padding-bottom: 2rem;
    }
    #gameFeedback {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.3); /* Transparenter Overlay, um das Feedback hervorzuheben */
      z-index: 0;
      transition: background-color 1s ease; /* sanfte ÃœbergÃ¤nge fÃ¼r Feedback */
      display: none;
    }
    #screenshot {
      max-width: 80vw;
      max-height: 50vh;
      border-radius: 1rem;
      margin-bottom: 1rem;
    }
    img {
      max-width: 80vw;
      max-height: 50vh;
      border-radius: 1rem;
      margin-bottom: 1rem;
    }
    select {
      padding: 0.5rem;
      font-size: 1rem;
      border-radius: 0.5rem;
      border: none;
    }
    #endScreen {
      display: none;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container" id="landing">
    <h1>R6 Map Guesser</h1>
    <p>Can you recognize Rainbow Six Siege maps from a single screenshot? Test your knowledge!</p>
    <label for="roundsSelect">Rounds: </label>
    <select id="roundsSelect">
      <option value="5">5 Rounds</option>
      <option value="10">10 Rounds</option>
    </select>
    <button onclick="startGame()">Play</button>
  </div>

  <div id="game">
    <div id="gameFeedback"></div>
    <p id="stats"></p>
    <img id="screenshot" src="" alt="Map screenshot">
    <select id="mapSelect">
      <option value="">Select a map</option>
    </select>
    <button onclick="checkAnswer()">Submit</button>
    <p id="result"></p>
  </div>

  <div id="endScreen">
    <h2>Game Over! GOLD GOLD GOLDðŸŽ‰</h2>
    <p id="finalScore"></p>
    <button onclick="startGame()">Play again</button>
    <button onclick="goToLanding()">Back to start</button>
  </div>

  <script>
    // Daten: Wie viele Screenshots pro Map vorhanden sind
    const mapData = {
      house: 16,
      oregon: 29,
      clubhouse: 31
    };

    // DropDown wird mit allen Map-Namen befÃ¼llt
    const mapSelect = document.getElementById('mapSelect');
    Object.keys(mapData).forEach(mapName => {
      const option = document.createElement('option');
      option.value = mapName.charAt(0).toUpperCase() + mapName.slice(1);
      option.textContent = option.value;
      mapSelect.appendChild(option);
    });

    // Alle Screenshots generieren mit Pfad und richtiger Antwort
    let allScreenshots = [];
    for (const [mapName, count] of Object.entries(mapData)) {
      for (let i = 1; i <= count; i++) {
        allScreenshots.push({
          src: `screenshots/${mapName}/${mapName}${i}.png`,
          answer: mapName.charAt(0).toUpperCase() + mapName.slice(1)
        });
      }
    }

    let roundCount = 5;
    let currentRound = 0;
    let score = 0;
    let current = {};
    let usedScreenshots = [];

    // ZurÃ¼ck zum Startbildschirm
    function goToLanding() {
      document.getElementById('endScreen').style.display = 'none';
      document.getElementById('landing').style.display = 'block';
      document.getElementById('game').style.display = 'none';
      score = 0;
      currentRound = 0;
      usedScreenshots = [];
    }

    // Spiel starten, Anzahl der Runden holen, Spielbildschirm anzeigen
    function startGame() {
      const roundSelect = document.getElementById('roundsSelect');
      roundCount = parseInt(roundSelect.value, 10) || 5;
      usedScreenshots = [];
      score = 0;
      currentRound = 0;

      document.getElementById('landing').style.display = 'none';
      document.getElementById('game').style.display = 'flex';
      document.getElementById('endScreen').style.display = 'none';

      updateStats();
      loadScreenshot();
    }

    // Screenshot laden und anzeigen
    function loadScreenshot() {
      if (currentRound >= roundCount) {
        endGame();
        return;
      }

      let unused = allScreenshots.filter(s => !usedScreenshots.includes(s.src));
      if (unused.length === 0) {
        endGame();
        return;
      }

      current = unused[Math.floor(Math.random() * unused.length)];
      usedScreenshots.push(current.src);
      currentRound++;

      const img = document.getElementById('screenshot');
      img.style.opacity = 0;
      img.onload = () => {
        img.style.opacity = 1;
      };

      img.src = current.src;
      document.getElementById('result').textContent = '';
      document.getElementById('mapSelect').value = '';
      updateStats();
    }

    // Runden- und Punktestand aktualisieren
    function updateStats() {
      if (!document.getElementById('roundInfo')) {
        const stats = document.getElementById('stats');
        stats.innerHTML = `<p id="roundInfo"></p><p id="scoreInfo"></p>`;
      }
      document.getElementById('roundInfo').textContent = `Round ${currentRound} of ${roundCount}`;
      document.getElementById('scoreInfo').textContent = `Points: ${score}`;
    }

    // Antwort Ã¼berprÃ¼fen und Feedback anzeigen
function checkAnswer() {
  const guess = document.getElementById('mapSelect').value;
  if (!guess) return;

  const result = document.getElementById('result');
  const imgContainer = document.getElementById('game'); // Der Container, der den Bildschirm darstellt
  const feedback = document.getElementById('gameFeedback');

   feedback.style.display = 'block';
  
  if (guess.toLowerCase() === current.answer.toLowerCase()) {
    score++;
    result.textContent = "Correct! ðŸŽ¯";
    result.style.color = 'green'; // Text wird grÃ¼n
    imgContainer.style.backgroundColor = 'rgba(0, 255, 0, 0.2)'; // Bildschirm wird sanft grÃ¼n
  } else {
    result.textContent = `Wrong! It was ${current.answer}.`;
    result.style.color = 'red'; // Text wird rot
    imgContainer.style.backgroundColor = 'rgba(255, 0, 0, 0.2)'; // Bildschirm wird sanft rot
  }

  updateStats();

  setTimeout(() => {
    feedback.style.display = 'none'; // Das Overlay nach der Pause ausblenden
    imgContainer.style.backgroundColor = '';
    loadScreenshot();
  }, 1500); // Die Hintergrundfarbe bleibt 1 Sekunde lang
}

    // Spiel beenden, Endscreen anzeigen
    function endGame() {
      document.getElementById('game').style.display = 'none';
      document.getElementById('endScreen').style.display = 'block';
      document.getElementById('finalScore').textContent = `You scored ${score} out of ${roundCount}!`;
    }
  </script>
</body>
</html>
