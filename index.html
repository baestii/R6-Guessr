<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>R6 Guessr</title>
  <link rel="icon" type="image/png" href="backgrounds/logo2.png">
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      color: #f4f4f4;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      overflow-x: hidden;
      backdrop-filter: blur(4px);
      transition: background-image 0.5s ease-in-out, opacity 0.5s ease-in-out;
    }
    .container {
      text-align: center;
    }
    h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }
    p {
      font-size: 1.1rem;
      margin-bottom: 2rem;
    }
    button {
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      background-color: #4e8cff;
      color: white;
      border: none;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
      margin-top: 1rem;
    }

  button:hover {
      background-color: #3a6edc;
      transform: scale(1.05);
      box-shadow: 0 0 10px rgba(78, 140, 255, 0.7);
    }
    #landing {
      background: linear-gradient(145deg, #2a2a3d, #1c1c2c);
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
      min-width: 300px;
      opacity: 0;
      transform: translate(-50%, -50%);
      position: absolute;
      top: 50%;
      left: 50%;
      animation: fadeIn 0.8s ease-in-out forwards;
    }
    #game {
      background: linear-gradient(135deg, #ff4ecb, #1e90ff);
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
      width: 90%;
      max-width: 1200px;
      margin: 2.5rem auto;   /*Abstand von Gamecointaner oben und unten zum Website-Rand */
      animation: zoomIn 0.5s ease forwards;
      transition: background-color 1s ease, opacity 0.5s ease;
      min-height: unset;
      overflow-y: auto;
      backdrop-filter: blur(8px);
    }
    #gameHeader {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      margin-bottom: 1rem;
    }

    #gameFeedback {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      transition: background-color 1s ease;
      display: none;
    }
    #screenshot.glow-correct {
      box-shadow: 0 0 25px 10px rgba(0, 255, 0, 0.5);
    }
    #screenshot.glow-wrong {
      box-shadow: 0 0 25px 10px rgba(255, 0, 0, 0.5);
    }
    #progressBarContainer {
      margin-top: 2rem;
      width: 70%;
      height: 15px;
      background-color: #333; 
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 1.5rem;
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.5);
    }
    #progressBar {
      height: 100%;
      width: 0%;
      background: linear-gradient(to right, 
                                  #8a2be2, 
                                  #6a5acd, 
                                  #9370db, 
                                  #ffd700  
                                 );
      background-size: 200% 100%;
      background-position: left center;
      border-radius: 5px;
      transition: width 0.5s ease, background-position 0.5s ease;
    }
    #damageOverlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8); 
  opacity: 0;
  pointer-events: none;
  z-index: 100000;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 5rem;
  font-weight: bold;
  color: white;
  text-shadow: 2px 2px 10px red;
  transition: opacity 0.5s ease;   
    }
    #soundToggleButtonGame {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  background: none;
  border: none;
  font-size: 1.6rem;
  cursor: pointer;
  padding: 0;
  line-height: 1;
}
  .sound-button-end {
  all: unset;
  position: absolute;
  top: 1rem;
  right: 1rem;
  cursor: pointer;
  font-size: 2rem;
  color: inherit;
}
.sound-button-end:hover {
  filter: brightness(1.2);
}
    #screenshot {
  width: 90%; /* Nicht ganz so breit */
  height: auto;
  aspect-ratio: 21 / 9;
  max-width: 1100px; /* Begrenzung, damit es nie zu groß wird */
  border-radius: 0.5rem;
  margin-bottom: 2rem; /* Weniger Abstand zu Submit */
  object-fit: cover;
  box-shadow: 0 0 15px rgba(0, 0, 0, 0.7);
}
    #screenshotContainer {
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    #mapButtonsContainer {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  margin-top: 0.5rem;
  margin-bottom: 1.5rem; 
  gap: 0.3rem;
  max-width: 100%;
}

.map-button {
  padding: 0.4rem 0.8rem;
  font-size: 0.9rem;
  background-color: #3a3a3a;
  color: #f4f4f4;
  border: 1px solid #666;
  border-radius: 0.4rem;
  cursor: pointer;
  transition: transform 0.2s ease, background-color 0.3s ease, box-shadow 0.3s ease;
}

.map-button:hover {
  transform: scale(1.1);
  background-color: #555;
  box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
  transition: transform 0.2s ease;
}

.map-button.selected {
  background: linear-gradient(135deg, #ffd700, #ffa500);
  color: #000;
  transform: scale(1.1);
  box-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
}

#feedbackOverlay {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: #2a2a3d;
  padding: 1.5rem 2.5rem;
  border-radius: 1rem;
  box-shadow: 0 0 25px rgba(255, 215, 0, 0.8);
  font-size: 2rem;
  font-weight: bold;
  color: white;
  opacity: 0;
  display: none;
  z-index: 10;
  transition: opacity 0.5s ease;
}

#screenshot.blurred {
  filter: blur(4px);
  transition: filter 0.3s ease;
}

/* Neuer Style für den Submit-Button */
#controls button {
  background-color: #3a3a3a;
  color: white;
  border: 1px solid #666;
  padding: 1.2rem 5rem; /*hier die 5 geändert */
  font-size: 1.6rem;
  font-weight: bold;
  border-radius: 1.2rem;
  cursor: pointer;
  transition: background-color 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease;
  margin-top: 1.5rem;
}

#controls button:hover {
  background-color: #32CD32; /* Lime Green */
  box-shadow: 0 0 15px rgba(50, 205, 50, 0.7);
  transform: scale(1.05);
}
  
#stats {
  position: absolute;
  top: 0.5rem;
  left: 0.5rem;
  display: flex;
  flex-direction: column;
  gap: 0.4rem;
  font-weight: bold;
  font-size: 1.2rem;
}

#roundInfo, #scoreInfo {
  background: rgba(0, 0, 0, 0.5);
  padding: 0.4rem 0.8rem;
  border-radius: 0.6rem;
}
    #mapSelect,
  #result,
  #game button {
    display: block;
    margin-top: 1rem
  }
    #controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 1rem;
    }

    #mapSelect, #controls button {
      margin-bottom: 0.5rem;
      padding: 0.5rem;
      font-size: 1rem;
      border-radius: 0.5rem;
      border: none;
    }
    #mapSelect {
    display: none;
    }
    img {
      max-width: 80vw;
      max-height: 50vh;
      border-radius: 1rem;
      margin-bottom: 1rem;
    }
    select {
      padding: 0.5rem;
      font-size: 1rem;
      border-radius: 0.5rem;
      border: none;
    }
   #endScreen {
  display: none;
  opactiy: 0;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: linear-gradient(145deg, #2a2a3d, #1c1c2c);
  padding: 5rem 3rem 2rem;
  border-radius: 1rem;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
  color: #f4f4f4;
  z-index: 9999;
  width: max-content;
  max-width: 90vw;
  opacity: 0;
  animation: epicEndScreen 0.3s ease forwards;
  text-align: center;
  overflow: hidden;
}
#endScreen h2 {
  font-size: 1.6rem;
  margin-bottom: 1rem;
  color: #ffe066;
  white-space: nowrap; /* NIE umbrechen */
  overflow: hidden;
  text-overflow: ellipsis; /* falls zu lang */
  max-width: 100%;
}

#endScreen p {
  font-size: 1.2rem;
  margin-bottom: 1.5rem;
}

#endScreen button {
  background-color: #4e8cff;
  color: white;
  padding: 0.6rem 1.2rem;
  font-size: 1rem;
  border: none;
  border-radius: 0.5rem;
  margin: 0.5rem;
  cursor: pointer;
  transition: background-color 0.3s ease, transform 0.2s ease;
}

#endScreen button:hover {
  background-color: #3a6edc;
  transform: scale(1.05);
}
  #result {
  display: inline-block;
  margin-top: 1rem;
  padding: 0.8rem 1.2rem;
  background: rgba(0, 0, 0, 0.6); /* leicht schwarzer Hintergrund */
  border-radius: 0.8rem;
  font-size: 1.5rem;
  font-weight: bold;
  box-shadow: 0 0 10px rgba(0,0,0,0.5);
  transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease;
}

/* Spezielle Styles für "Correct" */
#result.correct {
  background: rgba(0, 128, 0, 0.7); /* dunkles Grün */
  box-shadow: 0 0 15px rgba(0, 255, 0, 0.6);
}

/* Spezielle Styles für "Wrong" */
#result.wrong {
  background: rgba(128, 0, 0, 0.7); /* dunkles Rot */
  box-shadow: 0 0 15px rgba(255, 0, 0, 0.6);
}

#victoryOverlay {
  transition: opacity 1s ease;
  opacity: 0;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.4); /* leicht abdunkeln */
  display: none;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  z-index: 99999;
  overflow: hidden;
}

#victoryOverlay.active {
  display: flex;
  opacity: 1;
}
#victoryOverlay.fading-out {
  opacity: 0;
}
    
#lightBeams {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  overflow: hidden;
}

/* Glow Text */
#victoryText {
  font-size: 3rem;
  font-weight: bold;
  color: #ffe066;
  text-shadow: 0 0 10px #ffe066, 0 0 20px #ffd700, 0 0 30px #ffea00;
  z-index: 2;
  animation: glowPulse 2s infinite alternate;
  opacity: 0;
}

@keyframes glowPulse {
  from { text-shadow: 0 0 5px #ffe066, 0 0 10px #ffd700, 0 0 20px #ffea00; }
  to { text-shadow: 0 0 20px #ffe066, 0 0 30px #ffd700, 0 0 40px #ffea00; }
}

/* Emoji Animation */
.flying-emoji {
  position: absolute;
  font-size: 3.2rem;
  pointer-events: none;
  opacity: 0; 
  animation: flyRandom 1.5s linear forwards, fadeInEmoji 0.3s ease forwards; /* <- Animation ergänzt */
}

.beam {
  position: absolute;
  top: -30%;
  width: 40px;
  height: 160%;
  background: radial-gradient(circle at center, rgba(255,255,224,0.4) 0%, transparent 70%);
  opacity: 0;
  filter: blur(8px);
  transform-origin: top center;
  animation: beamSweep 4s infinite alternate ease-in-out, fadeInEmoji 0.3s ease forwards;
}
  #endScreen .sound-button-end {
  background: none !important;
  border: none !important;
  padding: 0 !important;
  margin: 0 !important;
  color: inherit;
  font-size: 2rem;
  cursor: pointer;
}  
    
@keyframes fadeInEmoji {
  from { opacity: 0; }
  to { opacity: 1; }
}
    
@keyframes beamSweep {
  0% { transform: rotate(-20deg); }
  100% { transform: rotate(20deg); }
}
    
@keyframes flyRandom {
  0% { opacity: 0; transform: translateY(100%) rotate(0deg); }
  50% { opacity: 1; }
  100% { opacity: 0; transform: translateY(-150%) rotate(360deg); }
}
    
@keyframes flyCrazy {
  0% {
    transform: translate(0, 0) rotate(0deg);
    opacity: 1;
  }
  100% {
    transform: translate(calc(100vw * var(--dx)), calc(100vh * var(--dy))) rotate(720deg);
    opacity: 0;
  }
}
/* Lightbeams */
@keyframes moveBeam {
  0% { transform: rotate(0deg) translateX(0); }
  100% { transform: rotate(20deg) translateX(20px); }
}  
@keyframes fadeIn {
  from { opacity: 0; transform: translate(-50%, -55%); }
  to { opacity: 1; transform: translate(-50%, -50%); }
}
@keyframes zoomIn {
  0% {
    transform: scale(0.95);
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}    
 @keyframes epicEndScreen {
  0% {
    transform: scale(0.8) rotate(-2deg);
    opacity: 0;
  }
  50% {
    transform: scale(1.05) rotate(2deg);
    opacity: 1;
  }
  100% {
    transform: scale(1) rotate(0deg);
    opacity: 1;
  }
}   

.map-button.selected {
  background-color: #6ab8ff; /* Helleres Blau */
  transform: scale(1.2);
}
    
  </style>
</head>
<body>
  <div class="container" id="landing">
    <h1>R6 Guessr</h1>
    <button id="soundToggleLanding" style="position: absolute; top: 20px; right: 20px; background: none; border: none; cursor: pointer;">
  🔊
    </button>
    <p>Can you recognize Rainbow Six Siege maps from a single screenshot? Test your knowledge!</p>
    <label for="roundsSelect">Rounds: </label>
    <select id="roundsSelect">
      <option value="5">5 Rounds</option>
      <option value="10">10 Rounds</option>
      <option value="15">15 Rounds</option>
      <option value="20">20 Rounds</option>
    </select>
    <label for="difficultySelect">Difficulty: </label>
    <select id="difficultySelect">
      <option value="mixed">Gemischt</option>
      <option value="easy">Easy</option>
      <option value="normal">Normal</option>
      <option value="hard">Hard</option>
      <option value="progressive">Gestaffelt</option>
    </select>
    <button onclick="startGame()">Play</button>
  </div>

 <div id="game">
  <div id="feedbackOverlay"></div>

  <div id="gameHeader">
    <div id="stats">
      <div id="roundInfo"></div>
      <div id="scoreInfo"></div>
    </div>
    <div id="progressBarContainer">
      <div id="progressBar"></div>
    </div>
    <button id="soundToggleButtonGame" aria-label="Toggle Sound">🔊</button>
  </div>

  <div id="gameFeedback"></div>

  <div id="screenshotContainer">
    <div id="mapButtonsContainer"></div>
    <img id="screenshot" src="" alt="Map screenshot">
  </div>

  <div id="controls">
    <select id="mapSelect">
      <option value="">Select a map</option>
    </select>
    <button onclick="checkAnswer()">Submit</button>
  </div>

  <div id="damageOverlay"></div>
  <p id="result"></p>
</div>

  <div id="endScreen">
    <div style="position: absolute; top: 20px; right: 20px;">
  <button id="soundToggleButtonEnd" class="sound-button-end">🔊</button>
</div>
    <h2 id="endScreenTitle" class="text-3xl font-bold mb-4"></h2>
    <p id="finalScore"></p>
    <button onclick="startGame()">Play again</button>
    <button onclick="goToLanding()">Back to start</button>
  </div>

  <div id="victoryOverlay">
    <div id="lightBeams"></div>
    <div id="victoryText">GOLD GOLD GOLD</div>
  </div>

 
    <audio id="hoverSound" src="sounds/hover.mp3"></audio>
    <audio id="clickSound" src="sounds/click.mp3"></audio>

      
  
  
  <script>
    const mapData = {
      house: { count: 16, easy: [1], normal: [2, 3, 7, 8, 9, 10, 12, 13], hard: [4, 5, 6, 11, 14, 15, 16] },
      oregon: { count: 29, easy: [2, 8, 9, 10, 15, 21, 24, 27], normal: [1, 3, 6, 11, 16, 18, 19, 20, 23, 26, 28, 29], hard: [4, 5, 7, 12, 13, 14, 17, 22, 25] },
      clubhouse: { count: 68, easy: [1, 3, 4, 6, 8, 12, 17, 18, 19, 22, 28, 30, 31, 38, 41, 42, 44, 55, 66], normal: [2, 5, 7, 10, 11, 15, 20, 23, 25, 27, 29, 32, 35, 36, 37, 39, 43, 47, 48, 50, 53, 56, 60, 62, 63, 67], hard: [9, 13, 14, 16, 21, 24, 26, 33, 34, 40, 45, 46, 49, 51, 52, 54, 57, 58, 59, 61, 64, 65, 68] },
      consulate: { count: 77, easy: [12, 14, 17, 22, 23, 38, 42, 43, 45, 47, 48, 53, 60, 65, 72], normal: [1, 3, 5, 15, 16, 18, 19, 20, 21, 24, 25, 28, 32, 33, 34, 35, 36, 39, 41, 44, 46, 49, 51, 52, 55, 57, 58, 59, 64, 67, 69, 70, 71, 76, 77], hard: [2, 4, 6, 7, 8, 9, 10, 11, 13, 26, 27, 29, 30, 31, 37, 40, 50, 54, 56, 61, 62, 63, 66, 68, 73, 74, 75] },
      plane: { count: 48, easy: [6, 10, 21, 23, 25, 28, 41, 44, 48], normal: [1, 2, 4, 7, 9, 14, 15, 18, 20, 24, 26, 31, 32, 33, 35, 37, 39, 40, 42, 43, 45], hard: [3, 5, 8, 11, 12, 13, 16, 17, 19, 22, 27, 29, 30, 34, 36, 38, 46, 47] },
      bank: { count: 78, easy: [1, 7, 10, 13, 16, 20, 25, 29, 30, 32, 47, 49, 51, 60, 61, 62, 67, 78], normal: [2, 4, 6, 8, 11, 14, 17, 18, 21, 22, 27, 28, 31, 34, 35, 36, 37, 38, 39, 41, 42, 44, 45, 46, 48, 50, 53, 54, 55, 58, 63, 64, 65, 66, 68, 75, 76], hard: [3, 5, 9, 12, 15, 19, 23, 24, 26, 33, 40, 43, 52, 56, 57, 59, 69, 70, 71, 72, 73, 74, 77] },
      kanal: { count: 97, easy: [5, 8, 11, 12, 14, 19, 24, 27, 31, 34, 39, 42, 47, 51, 52, 54, 55, 56, 58, 61, 65, 66, 67, 76, 81, 86, 87], normal: [3, 4, 7, 10, 13, 20, 22, 26, 28, 29, 30, 33, 35, 37, 38, 40, 43, 44, 46, 48, 49, 57, 59, 68, 70, 71, 73, 75, 82, 83, 89, 91, 95, 96, 97], hard: [1, 2, 6, 9, 15, 16, 17, 18, 21, 23, 25, 32, 36, 41, 45, 50, 53, 60, 62, 63, 64, 69, 72, 74, 77, 78, 79, 80, 84, 85, 88, 90, 92, 93, 94] },
      chalet: { count: 0, easy: [], normal: [], hard: [] },
      cafe: { count: 0, easy: [], normal: [], hard: [] },
      yacht: { count: 0, easy: [], normal: [], hard: [] },
      border: { count: 0, easy: [], normal: [], hard: [] },
      favela: { count: 0, easy: [], normal: [], hard: [] },
      skyscraper: { count: 0, easy: [], normal: [], hard: [] },
      coastline: { count: 0, easy: [], normal: [], hard: [] },
      themepark: { count: 0, easy: [], normal: [], hard: [] },
      tower: { count: 0, easy: [], normal: [], hard: [] },
      villa: { count: 0, easy: [], normal: [], hard: [] },
      fortress: { count: 0, easy: [], normal: [], hard: [] },
      outback: { count: 0, easy: [], normal: [], hard: [] },
      emeraldplains: { count: 0, easy: [], normal: [], hard: [] },
      stadiumbravo: { count: 0, easy: [], normal: [], hard: [] },
      nighthavenlabs: { count: 0, easy: [], normal: [], hard: [] },
      lair: { count: 0, easy: [], normal: [], hard: [] },
      stadium2020: { count: 0, easy: [], normal: [], hard: [] }
    };

     const mapSelect = document.getElementById('mapSelect');

    const hoverSound = document.getElementById('hoverSound');
            hoverSound.volume = 0.2;
    
// Maps, die schöner geschrieben werden sollen
const multiWordMaps = {
  emeraldplains: "Emerald Plains",
  stadiumbravo: "Stadium Bravo",
  nighthavenlabs: "Nighthaven Labs",
  stadium2020: "Stadium 2020",
  themepark: "Theme Park",
  cafe: "Café", 
  };


  const victorySounds = [
  { path: "sounds/victory1.mp3", weight: 7 },
  { path: "sounds/victory2.mp3", weight: 30 },
  { path: "sounds/victory3.mp3", weight: 5 },
  { path: "sounds/victory4.mp3", weight: 30 },
  { path: "sounds/victory5.mp3", weight: 28 }
];

const respectSounds = [
  { path: "sounds/respect1.mp3", weight: 28 },
  { path: "sounds/respect2.mp3", weight: 28 },
  { path: "sounds/respect3.mp3", weight: 15 },
  { path: "sounds/respect4.mp3", weight: 29 }
];

const failureSounds = [
  { path: "sounds/failure1.mp3", weight: 17 },
  { path: "sounds/failure2.mp3", weight: 50 },
  { path: "sounds/failure3.mp3", weight: 17 },
  { path: "sounds/failure4.mp3", weight: 16 }
];

    
    
   // Sound-Volume-Settings
  const soundVolumes = {

  "sounds/click.mp3": 0.4,
  // Victory Sounds
  "sounds/victory1.mp3": 0.2,
  "sounds/victory2.mp3": 0.2,
  "sounds/victory3.mp3": 0.3,
  "sounds/victory4.mp3": 0.15,
  "sounds/victory5.mp3": 0.3,

  // Respect Sounds
  "sounds/respect1.mp3": 1,
  "sounds/respect2.mp3": 0.2,
  "sounds/respect3.mp3": 0.3,
  "sounds/respect4.mp3": 1,

  // Failure Sounds
  "sounds/failure1.mp3": 0.05,
  "sounds/failure2.mp3": 0.7,
  "sounds/failure3.mp3": 0.2,
  "sounds/failure4.mp3": 0.3,
};

  
    
Object.keys(mapData).forEach(mapName => {
  const option = document.createElement('option');
  option.value = mapName.charAt(0).toUpperCase() + mapName.slice(1);

  if (multiWordMaps[mapName]) {
    option.textContent = multiWordMaps[mapName];
  } else {
    // Standard: Erster Buchstabe groß, Rest normal
    option.textContent = mapName.charAt(0).toUpperCase() + mapName.slice(1);
  }

  mapSelect.appendChild(option);
});

 
  
    
    let roundCount = 5;
    let currentRound = 0;
    let score = 0;
    let current = {};
    let usedScreenshots = [];
    let difficulty = 'mixed';
    let availableScreenshots = [];
    let soundEnabled = true; // Standardmäßig an
    let endScreenAudio = null;
    let selectedMapButton = null; // aktuell ausgewählter Button merken


    function selectRandom(array, count) {
  const shuffled = array.slice().sort(() => 0.5 - Math.random());
  return shuffled.slice(0, count);
}
    
    function startGame()   {
      
       if (endScreenAudio) {
        endScreenAudio.pause();
        endScreenAudio.currentTime = 0;
        endScreenAudio = null;
    }
      
      const roundSelect = document.getElementById('roundsSelect');
      roundCount = parseInt(roundSelect.value, 10) || 5;
      difficulty = document.getElementById('difficultySelect').value;
      usedScreenshots = [];
      score = 0;
      currentRound = 0;

        generateAvailableScreenshots();

      document.getElementById('landing').style.display = 'none';
      document.getElementById('game').style.display = 'flex';
      document.getElementById('endScreen').style.display = 'none';

        updateStats();
        loadScreenshot();
    }
    
    function goToLanding() {
      
      if (endScreenAudio) {
        endScreenAudio.pause();
        endScreenAudio.currentTime = 0;
        endScreenAudio = null;
    }
      document.getElementById('endScreen').style.display = 'none';
      document.getElementById('landing').style.display = 'block';
      document.getElementById('game').style.display = 'none';
      score = 0;
      currentRound = 0;
      usedScreenshots = [];

      setRandomLandingBackground(); // Nur aufrufen, NICHT neu definieren!
}

      function setRandomLandingBackground() {
        const numberOfBackgrounds = 30; // <<< HIER einfach die Gesamtanzahl deiner Backgrounds eintragen!
        const randomNumber = Math.floor(Math.random() * numberOfBackgrounds) + 1;
        const randomImage = `backgrounds/background${randomNumber}.jpg`;

        const body = document.body;
        body.style.opacity = 0;

        setTimeout(() => {
          body.style.backgroundImage = `url('${randomImage}')`;
          body.style.opacity = 1;
        }, 100);
      }

    
    function generateAvailableScreenshots() {
  availableScreenshots = [];
  
      
  const mapNames = Object.keys(mapData);
  const isProgressive = difficulty === 'progressive';
  const mapUsage = {};
  const maxPerMap = Math.floor(roundCount * 0.2);

  let initialScreenshots = [];

  for (const mapName of mapNames) {
  const data = mapData[mapName];
  
    if (data.count === 0) continue;
    let difficultySequence = [];

    if (difficulty === 'easy') difficultySequence = data.easy;
    else if (difficulty === 'normal') difficultySequence = data.normal;
    else if (difficulty === 'hard') difficultySequence = data.hard;
    else if (difficulty === 'progressive') {
      const totalRounds = roundCount;
      const easyCount = Math.floor(totalRounds / 3);
      const normalCount = Math.floor(totalRounds / 3);
      const hardCount = totalRounds - easyCount - normalCount;

      const easy = data.easy.slice(0, easyCount);
      const normal = data.normal.slice(0, normalCount);
      const hard = data.hard.slice(0, hardCount);

      difficultySequence = [...easy, ...normal, ...hard];
    } else {
      difficultySequence = Array.from({ length: data.count }, (_, i) => i + 1);
    }

    difficultySequence.forEach(i => {
      initialScreenshots.push({
        src: `screenshots/${mapName}/${mapName}${i}.png`,
        answer: mapName.charAt(0).toUpperCase() + mapName.slice(1)
      });
    });
  }


  // Shuffle initialScreenshots
  for (let i = initialScreenshots.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [initialScreenshots[i], initialScreenshots[j]] = [initialScreenshots[j], initialScreenshots[i]];
  }

  // Map-Limit berücksichtigen
  for (const candidate of initialScreenshots) {
    const mapName = candidate.answer.toLowerCase();
    if (!mapUsage[mapName]) mapUsage[mapName] = 0;
    if (mapUsage[mapName] >= maxPerMap) continue;

    availableScreenshots.push(candidate);
    mapUsage[mapName]++;

    if (availableScreenshots.length >= roundCount) break;
  }
}

      // Zufällige Auswahl für "gestaffelt"
      if (difficulty === 'progressive') {
        const easy = availableScreenshots.filter(s => mapData[s.answer.toLowerCase()].easy.includes(parseInt(s.src.match(/(\d+)\.png$/)[1])));
        const normal = availableScreenshots.filter(s => mapData[s.answer.toLowerCase()].normal.includes(parseInt(s.src.match(/(\d+)\.png$/)[1])));
        const hard = availableScreenshots.filter(s => mapData[s.answer.toLowerCase()].hard.includes(parseInt(s.src.match(/(\d+)\.png$/)[1])));

    // Für "gestaffelt" die Runden zufällig aus den Kategorien auswählen
      availableScreenshots = [
        ...selectRandom(easy, Math.floor(roundCount / 3)),
        ...selectRandom(normal, Math.floor(roundCount / 3)),
        ...selectRandom(hard, roundCount - Math.floor(roundCount / 3) * 2)
    ];
  }


      
    function loadScreenshot() {
      if (currentRound >= roundCount) {
     
        endGame();
        return;
      }

      if (difficulty === 'progressive') {
      if (currentRound >= availableScreenshots.length) {
        endGame();
        return;
       }
      current = availableScreenshots[currentRound];
    } else {
      let unused = availableScreenshots.filter(s => !usedScreenshots.includes(s.src));
      if (unused.length === 0) {
        endGame();
        return;
     }
      current = unused[Math.floor(Math.random() * unused.length)];
      usedScreenshots.push(current.src);
    }
      currentRound++;

      if (selectedMapButton) {
          selectedMapButton.classList.remove('selected');
          selectedMapButton.style.background = '';
          selectedMapButton.style.boxShadow = '';
          selectedMapButton = null;
      }

      const img = document.getElementById('screenshot');
      img.style.opacity = 0;
      img.onload = () => {
        img.style.opacity = 1;
      };

      img.src = current.src;
      document.getElementById('result').style.display = 'none';
      document.getElementById('result').textContent = '';
      document.getElementById('mapSelect').value = '';
      updateStats();
    }

    function updateStats() {
      if (!document.getElementById('roundInfo')) {
        const stats = document.getElementById('stats');
        stats.innerHTML = `<p id="roundInfo"></p><p id="scoreInfo"></p>`;
      }
      document.getElementById('roundInfo').textContent = `Round ${currentRound} of ${roundCount}`;
      document.getElementById('scoreInfo').textContent = `Points: ${score}`;

      const progressBar = document.getElementById('progressBar');
      if (progressBar) {
        const percent = (currentRound / roundCount) * 100;
        progressBar.style.width = `${percent}%`;
        progressBar.style.backgroundPosition = `${percent}% center`;
      }
    }
    
    function checkAnswer() {
  const guess = document.getElementById('mapSelect').value;
  if (!guess) return;

  const feedbackOverlay = document.getElementById('feedbackOverlay');
  const screenshot = document.getElementById('screenshot');

  screenshot.classList.add('blurred');

  if (guess.toLowerCase() === current.answer.toLowerCase()) {
    score++;
    feedbackOverlay.textContent = "Correct! 🎯";
    feedbackOverlay.style.background = "linear-gradient(135deg, #228B22, #32CD32)"; // Grüner Verlauf bei korrekt
    feedbackOverlay.style.boxShadow = "0 0 25px rgba(0, 255, 0, 0.8)";
  } else {
    feedbackOverlay.textContent = `Wrong! ❌ It was ${current.answer}.`;
    feedbackOverlay.style.background = "linear-gradient(135deg, #8B0000, #FF4500)"; // Roter Verlauf bei falsch
    feedbackOverlay.style.boxShadow = "0 0 25px rgba(255, 0, 0, 0.8)";
  }

  feedbackOverlay.style.display = 'block';
  
  // Leicht verzögert, damit Transition greift
  setTimeout(() => {
    feedbackOverlay.style.opacity = 1;
  }, 50);

  updateStats();

  setTimeout(() => {
    feedbackOverlay.style.opacity = 0;

    // Nach der Fade-Out Zeit (500ms) wieder display:none setzen
    setTimeout(() => {
      feedbackOverlay.style.display = 'none';
      screenshot.classList.remove('blurred');
      loadScreenshot();
    }, 500);

  }, 1500);
}

        

        function weightedRandomSound(soundsArray) {
          const totalWeight = soundsArray.reduce((acc, sound) => acc + sound.weight, 0);
          let random = Math.random() * totalWeight;

          for (const sound of soundsArray) {
            if (random < sound.weight) {
            return sound.path;
            }
            random -= sound.weight;
            }

            // Falls irgendwas schiefgeht, nimm den ersten Sound
            return soundsArray[0].path;
      }

        function triggerVictoryCelebration() {
    console.log("Victory Celebration triggered!");

    const selectedSound = weightedRandomSound(victorySounds);
    if (endScreenAudio) {
        endScreenAudio.pause();
        endScreenAudio.currentTime = 0;
    }
    endScreenAudio = new Audio(selectedSound);
    endScreenAudio.volume = soundVolumes[selectedSound] || 0.7;
    endScreenAudio.play();

    // Neues: Victory Overlay anzeigen
    const overlay = document.getElementById('victoryOverlay');
    overlay.style.display = 'flex';
    overlay.classList.add('active');

    // Lightbeams starten
    startLightBeams();
    // Emojis starten
    launchVictoryEmojis();

    setTimeout(() => {
        overlay.classList.add('fading-out');

        // Nach dem Fadeout wieder richtig verstecken
        setTimeout(() => {
            overlay.classList.remove('active', 'fading-out');
            overlay.style.display = 'none';
            document.getElementById('endScreen').style.display = 'block';
        }, 300); // Fadeout dauert 1s
    }, 2500); // 4 Sekunden sichtbar bleiben
}

function startLightBeams() {
    const lightBeamsContainer = document.getElementById('lightBeams');
    lightBeamsContainer.innerHTML = '';

    for (let i = 0; i < 3; i++) {
        const beam = document.createElement('div');
        beam.classList.add('beam');
        beam.style.left = `${Math.random() * 80 + 10}%`;
        beam.style.animationDelay = `${Math.random() * 2}s`;
        lightBeamsContainer.appendChild(beam);
    }
}

function launchVictoryEmojis() {
    const emojis = ['🥇', '🎉', '🏆', '✨', '🔥', '🎊', '🌟', '💎', '💥', '⚡', '🎖️', '🍀'];
    const overlay = document.getElementById('victoryOverlay');

    for (let i = 0; i < 35; i++) {
        const emoji = document.createElement('div');
        emoji.classList.add('flying-emoji');
        emoji.innerText = emojis[Math.floor(Math.random() * emojis.length)];

        // Zufällige Position
        emoji.style.left = Math.random() * 100 + "vw";
        emoji.style.top = Math.random() * 100 + "vh";

        // Zufällige Flugrichtung
        const dx = (Math.random() - 0.5) * 2; // Wert zwischen -1 und 1
        const dy = (Math.random() - 0.5) * 2;

        emoji.style.setProperty('--dx', dx);
        emoji.style.setProperty('--dy', dy);

        // Zufällige Geschwindigkeit
        const duration = (3 + Math.random() * 4).toFixed(2); // 3-7 Sekunden
        emoji.style.animation = `flyCrazy ${duration}s linear forwards`;

        // Zufällige Größe
        const scale = (0.7 + Math.random() * 1.5).toFixed(2); // 0.7x bis 2.2x
        emoji.style.transform = `scale(${scale})`;

        overlay.appendChild(emoji);

        // Länger drin lassen (wird NICHT gelöscht direkt)
        setTimeout(() => {
            emoji.remove();
        }, duration * 1000 + 2000); // Animation + 2 Sekunden Puffer
    }
}

        function triggerRespectCelebration() {
    console.log("Respect Celebration triggered!");

    const selectedSound = weightedRandomSound(respectSounds);
    if (endScreenAudio) {
        endScreenAudio.pause();
        endScreenAudio.currentTime = 0;
    }
    endScreenAudio = new Audio(selectedSound);
    endScreenAudio.volume = soundVolumes[selectedSound] || 0.7;
    endScreenAudio.play();

    const overlay = document.getElementById('victoryOverlay');
    overlay.innerHTML = ''; // Leeren
    overlay.style.background = 'rgba(0, 0, 0, 0.4)'; // Startfarbe

    overlay.style.display = 'flex';
    overlay.classList.add('active');

    // Neuer sanfter Übergang ins Blau
    setTimeout(() => {
      overlay.style.transition = 'background 1.5s ease';
      overlay.style.background = 'rgba(70, 130, 180, 0.5)'; // SteelBlue Farbe
    }, 100);

    // Emojis starten
    launchRespectEmojis();

    setTimeout(() => {
        overlay.style.transition = 'opacity 1s ease'; // <- Wichtig
        overlay.style.opacity = 0;

        setTimeout(() => {
            overlay.classList.remove('active', 'fading-out');
            overlay.style.display = 'none';
            overlay.style.opacity = 1; 
            document.getElementById('endScreen').style.display = 'block';
        }, 1000);
    }, 1800);
}

function launchRespectEmojis() {
    const emojis = ['👏', '🔥', '✨', '🏅', '🙌', '💪', '🤝', '🤙', '😎'];
    const overlay = document.getElementById('victoryOverlay');

    for (let i = 0; i < 35; i++) {
        const emoji = document.createElement('div');
        emoji.classList.add('flying-emoji');
        emoji.innerText = emojis[Math.floor(Math.random() * emojis.length)];

        // Zufällige Position
        emoji.style.left = Math.random() * 100 + "vw";
        emoji.style.top = Math.random() * 100 + "vh";

        // Zufällige Flugrichtung
        const dx = (Math.random() - 0.5) * 2; // Wert zwischen -1 und 1
        const dy = (Math.random() - 0.5) * 2;

        emoji.style.setProperty('--dx', dx);
        emoji.style.setProperty('--dy', dy);

        // Zufällige Geschwindigkeit
        const duration = (3 + Math.random() * 4).toFixed(2); // 3-7 Sekunden
        emoji.style.animation = `flyCrazy ${duration}s linear forwards`;

        // Zufällige Größe
        const scale = (0.7 + Math.random() * 1.5).toFixed(2); // 0.7x bis 2.2x
        emoji.style.transform = `scale(${scale})`;

        overlay.appendChild(emoji);

        // Länger drin lassen (wird NICHT gelöscht direkt)
        setTimeout(() => {
            emoji.remove();
        }, duration * 1000 + 2000); // Animation + 2 Sekunden Puffer
    }
}

        function triggerFailureAnimation() {
    console.log("Failure Animation triggered!");

    const damageOverlay = document.getElementById('damageOverlay');
    const overlay = document.getElementById('victoryOverlay');

    const selectedSound = weightedRandomSound(failureSounds);
    if (endScreenAudio) {
        endScreenAudio.pause();
        endScreenAudio.currentTime = 0;
    }
    endScreenAudio = new Audio(selectedSound);
    endScreenAudio.volume = soundVolumes[selectedSound] || 0.7;
    endScreenAudio.play();

    overlay.innerHTML = ''; // Emojis vorbereiten
    overlay.style.background = 'transparent';
    overlay.style.pointerEvents = 'none';
    overlay.style.display = 'flex';
    overlay.classList.add('active');

    launchFailureEmojis(); // Emojis fliegen!

    // Jetzt den großen Text einblenden
    const randomText = Math.random() < 0.5 ? "You Died" : "WASTED";
    damageOverlay.innerText = randomText;
    damageOverlay.style.opacity = 1;

    setTimeout(() => {
    overlay.classList.add('fading-out');
    setTimeout(() => {
        overlay.classList.remove('active', 'fading-out');
        overlay.style.display = 'none';
        overlay.style.pointerEvents = 'auto'; 
        
        // Jetzt ERST Endscreen sauber einblenden
        const endScreen = document.getElementById('endScreen');
        endScreen.style.display = 'flex';
        setTimeout(() => {
          endScreen.style.opacity = 1;
        }, 50); // kleine Pause damit Flex-Layout greifen kann
    }, 300);
}, 2500);

        }
function launchFailureEmojis() {
    const emojis = ['💀', '☠️', '🥀', '🤡', '😭', '🥴', '😞', '😔'];
    const overlay = document.getElementById('victoryOverlay');

    for (let i = 0; i < 35; i++) {
        const emoji = document.createElement('div');
        emoji.classList.add('flying-emoji');
        emoji.innerText = emojis[Math.floor(Math.random() * emojis.length)];

        // Zufällige Position
        emoji.style.left = Math.random() * 100 + "vw";
        emoji.style.top = Math.random() * 100 + "vh";

        // Zufällige Flugrichtung
        const dx = (Math.random() - 0.5) * 2; // Wert zwischen -1 und 1
        const dy = (Math.random() - 0.5) * 2;

        emoji.style.setProperty('--dx', dx);
        emoji.style.setProperty('--dy', dy);

        // Zufällige Geschwindigkeit
        const duration = (3 + Math.random() * 4).toFixed(2); // 3-7 Sekunden
        emoji.style.animation = `flyCrazy ${duration}s linear forwards`;

        // Zufällige Größe
        const scale = (0.7 + Math.random() * 1.5).toFixed(2); // 0.7x bis 2.2x
        emoji.style.transform = `scale(${scale})`;

        overlay.appendChild(emoji);

        // Länger drin lassen (wird NICHT gelöscht direkt)
        setTimeout(() => {
            emoji.remove();
        }, duration * 1000 + 2000); // Animation + 2 Sekunden Puffer
    }
}

 const victoryTexts = [
  "GOLD GOLD GOLD",
  "Winner Winner Chicken Dinner",
  "Victory Royale!",
  "You are the Champion!",
  "Mission Passed! Respect +",
  "Achievement Unlocked: Unstoppable",
  "Legendary Win!",
  "No One Stands a Chance!",
  "You are HIM",
  "Certified Map Guessr.",
  "Built Different™.",
  "Peak Performance Achieved.",
  "No Map Stands a Chance.",
  "Too easy, honestly.",
  "Unmatched.",
  "Skill Issue? Not yours.",
  "Maximum Overdrive Mode.",
  "Boss Level Unlocked."
];

const respectTexts = [
  "MVP Vibes! But not yet",
  "Almost made it to greatness!",
  "Mediocre at best.",
  "Participation trophy earned!",
  "Solid... kinda.",
  "One foot in the hall of fame.",
  "Close enough for participation points.",
  "Respectable effort! (Sorta.)",
  "You're like 3rd place energy.",
  "Respectable... for now.",
  "Somewhere between decent and legend.",
  "Almost cracked.",
  "Better than average, worse than great.",
  "You ate, but left some crumbs.",
  "Warming up, huh?",
  "So near, yet so meme.",
  "Congrats, you’re decent... sometimes.",
  "Almost legendary. Almost."
];

const failureTexts = [
  "Better Luck Next Time.",
  "Mission Failed. We'll Get 'Em Next Time.",
  "Press F to Pay Respects",
  "Oof. That Was Rough.",
  "At Least You Tried!",
  "Never Give Up!",
  "Pain.",
  "You are not HIM",
  "Tough day at the office.",
  "Not like this... 💀",
  "Skill Issue.",
  "Loading... Skills (0%).",
  "Respawn and try again.",
  "Dreams shattered. Try again?",
  "Was it lag? Surely it was lag.",
  "You lost. But like... in a special way.",
  "Life gave you a chance. You fumbled it.",
  "Better luck next patch.",
  "You got cooked.",
  "Gave it your all. Should have given more.",
  "You failed with flair. Kinda iconic.",
  "This loss belongs in a museum.",
  "Even RNG couldn't save you.",
  "Better uninstall... just kidding. Or not."
]; 
  
  const rareVictoryTexts = [
  "You unlocked a Rare Dub!",
  "Skill Level: Uninstall other players.",
  "You got a rare text... and you earned it.",
  "You’re the main character now.",
  "Rare W detected.",
  "A dub so clean it's under investigation.",
  "You 100% the tutorial. Twice."
];

const rareRespectTexts = [
  "Close enough to feel pain.",
  "This rare text won’t save you.",
  "Solid attempt. Rare encouragement unlocked.",
  "Rare Respect drop! Almost not bad!",
  "This is a rare text, but you’re still mid.",
  "Rare text. Mid performance. Balanced.",
];

const rareFailureTexts = [
  "Respawned... into another loss.",
  "You found a rare text. Not a win, though.",
  "Rare clown moment unlocked 🤡.",
  "This text is rare. Your skills aren’t.",
  "Statistically, this shouldn't happen... yet here we are.",
  "Achievement Unlocked: Legendary Loss."
];

function getRandomTextWithRare(commonArray, rareArray, rareChance = 0.1) {
  if (Math.random() < rareChance && rareArray.length > 0) {
    return rareArray[Math.floor(Math.random() * rareArray.length)];
  } else {
    return commonArray[Math.floor(Math.random() * commonArray.length)];
  }
}
    
    
     function endGame() {
        document.getElementById('finalScore').textContent = `You scored ${score} out of ${roundCount}!`;
        document.getElementById('endScreen').style.opacity = '1';
        document.getElementById('gameFeedback').style.display = 'none';
        document.getElementById('game').style.display = 'none';
        document.getElementById('landing').style.display = "none";

       const performance = (score / roundCount) * 100;

        if (performance >= 90) {
  document.querySelector('#endScreenTitle').textContent = getRandomTextWithRare(victoryTexts, rareVictoryTexts);
  triggerVictoryCelebration();
} else if (performance >= 50) {
  document.querySelector('#endScreenTitle').textContent = getRandomTextWithRare(respectTexts, rareRespectTexts);
  triggerRespectCelebration();
} else {
  document.querySelector('#endScreenTitle').textContent = getRandomTextWithRare(failureTexts, rareFailureTexts);
  triggerFailureAnimation();
}
     
    }
      window.addEventListener('DOMContentLoaded', () => {
        
      const hoverSound = document.getElementById('hoverSound');
      const clickSound = document.getElementById('clickSound');
      const allSoundButtons = [
      document.getElementById('soundToggleLanding'),
      document.getElementById('soundToggleButtonGame'),
      document.getElementById('soundToggleButtonEnd')
      ].filter(Boolean);

        allSoundButtons.forEach(btn => {
            btn.addEventListener('click', () => {
            soundEnabled = !soundEnabled;
            allSoundButtons.forEach(b => b.textContent = soundEnabled ? "🔊" : "🔇");
  });
});

  const buttons = document.querySelectorAll('button');

buttons.forEach(button => {
  button.addEventListener('click', () => {
    if (clickSound && soundEnabled) {
      clickSound.currentTime = 0;
      clickSound.play();
    }
  });

  button.addEventListener('mouseenter', () => {
    if (hoverSound && soundEnabled) {
      hoverSound.currentTime = 0;
      hoverSound.play();
    }
  });
});
  const options = document.querySelectorAll('option');
  const selects = document.querySelectorAll('select');
selects.forEach(select => {
  select.addEventListener('mouseover', () => {
    if (hoverSound && soundEnabled) {
      hoverSound.currentTime = 0;
      hoverSound.play();
    }
  });
});
        

  // Hover-Sound nur bei Options
  options.forEach(option => {
  option.addEventListener('mouseenter', () => {
    if (hoverSound && soundEnabled) {
      hoverSound.currentTime = 0;
      hoverSound.play();
    }
  });
});

  // Click-Sound nur bei Buttons
  buttons.forEach(button => {
    button.addEventListener('click', () => {
      if (clickSound && soundEnabled) {
        clickSound.currentTime = 0;
        clickSound.play();
      }
    });
  });


// Alle Optionen aus mapSelect in Buttons umwandeln
Array.from(mapSelect.options).forEach(option => {
  if (option.value !== "") {
    const button = document.createElement('button');
    button.classList.add('map-button');
    button.textContent = option.textContent;

    button.addEventListener('mouseenter', () => {
      if (hoverSound && soundEnabled) {
        hoverSound.currentTime = 0;
        hoverSound.play();
      }
    });

    button.addEventListener('click', () => {
      mapSelect.value = option.value; // Auswahl setzen
      
      // alte Markierung entfernen
      if (selectedMapButton) {
        selectedMapButton.classList.remove('selected');
      }
      // neue Markierung setzen
      button.classList.add('selected');
      selectedMapButton = button;
    });

    mapButtonsContainer.appendChild(button);
  }
});       

  setRandomLandingBackground();
  document.getElementById('landing').style.opacity = 1;
});
    
  </script>
 
</body>
</html>
