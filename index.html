<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>R6 Map Guesser</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #1e1e2f;
      color: #f4f4f4;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
    }
    .container {
      text-align: center;
    }
    h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }
    p {
      font-size: 1.1rem;
      margin-bottom: 2rem;
    }
    button {
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      background-color: #4e8cff;
      color: white;
      border: none;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 1rem;
    }
    button:hover {
      background-color: #3a6edc;
    }
    #game {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
      height: 100%;
      width: 100%;
      position: relative;
      z-index: 1;
      transition: background-color 1s ease;
      padding-bottom: 2rem;
    }
    #gameFeedback {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.3);
      z-index: 0;
      transition: background-color 1s ease;
      display: none;
    }
    #screenshot, img {
      max-width: 80vw;
      max-height: 50vh;
      border-radius: 1rem;
      margin-bottom: 1rem;
    }
    select {
      padding: 0.5rem;
      font-size: 1rem;
      border-radius: 0.5rem;
      border: none;
    }
    #endScreen {
      display: none;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container" id="landing">
    <h1>R6 Map Guesser</h1>
    <p>Can you recognize Rainbow Six Siege maps from a single screenshot? Test your knowledge!</p>
    <label for="roundsSelect">Rounds: </label>
    <select id="roundsSelect">
      <option value="5">5 Rounds</option>
      <option value="10">10 Rounds</option>
    </select>
    <label for="difficultySelect">Difficulty: </label>
    <select id="difficultySelect">
      <option value="mixed">Gemischt</option>
      <option value="easy">Easy</option>
      <option value="normal">Normal</option>
      <option value="hard">Hard</option>
      <option value="progressive">Gestaffelt</option>
    </select>
    <button onclick="startGame()">Play</button>
  </div>

  <div id="game">
    <div id="gameFeedback"></div>
    <p id="stats"></p>
    <img id="screenshot" src="" alt="Map screenshot">
    <select id="mapSelect">
      <option value="">Select a map</option>
    </select>
    <button onclick="checkAnswer()">Submit</button>
    <p id="result"></p>
  </div>

  <div id="endScreen">
    <h2>Game Over! GOLD GOLD GOLDðŸŽ‰</h2>
    <p id="finalScore"></p>
    <button onclick="startGame()">Play again</button>
    <button onclick="goToLanding()">Back to start</button>
  </div>

  <script>
    const mapData = {
      house: { count: 16, easy: [1, 2, 4, 6], normal: [3, 5, 7], hard: [8, 9, 10] },
      oregon: { count: 29, easy: [1, 2, 3], normal: [4, 5, 6], hard: [7, 8, 9] },
      clubhouse: { count: 68, easy: [1, 2, 3], normal: [4, 5, 6], hard: [7, 8, 9] },
      consulate: { count: 77, easy: [1, 2, 3], normal: [4, 5, 6], hard: [7, 8, 9] }
    };

    const mapSelect = document.getElementById('mapSelect');
    Object.keys(mapData).forEach(mapName => {
      const option = document.createElement('option');
      option.value = mapName.charAt(0).toUpperCase() + mapName.slice(1);
      option.textContent = option.value;
      mapSelect.appendChild(option);
    });

    function generateScreenshots(difficulty, rounds) {
      const shots = [];
      const keys = Object.keys(mapData);

      function addShotsFromDifficulty(level, num) {
        while (num > 0) {
          const map = keys[Math.floor(Math.random() * keys.length)];
          const available = mapData[map][level];
          if (available?.length) {
            const idx = available[Math.floor(Math.random() * available.length)];
            shots.push({ src: `screenshots/${map}/${map}${idx}.png`, answer: map.charAt(0).toUpperCase() + map.slice(1) });
            num--;
          }
        }
      }

      switch (difficulty) {
        case 'easy': addShotsFromDifficulty('easy', rounds); break;
        case 'normal': addShotsFromDifficulty('normal', rounds); break;
        case 'hard': addShotsFromDifficulty('hard', rounds); break;
        case 'progressive': {
          const easy = Math.floor(rounds / 3);
          const normal = Math.floor(rounds / 3);
          const hard = rounds - easy - normal;
          addShotsFromDifficulty('easy', easy);
          addShotsFromDifficulty('normal', normal);
          addShotsFromDifficulty('hard', hard);
          break;
        }
        default: {
          for (let i = 0; i < rounds; i++) {
            const map = keys[Math.floor(Math.random() * keys.length)];
            const num = Math.floor(Math.random() * mapData[map].count) + 1;
            shots.push({ src: `screenshots/${map}/${map}${num}.png`, answer: map.charAt(0).toUpperCase() + map.slice(1) });
          }
        }
      }
      return shots;
    }

    let allScreenshots = [];
    let roundCount = 5;
    let currentRound = 0;
    let score = 0;
    let current = {};

    function goToLanding() {
      document.getElementById('endScreen').style.display = 'none';
      document.getElementById('landing').style.display = 'block';
      document.getElementById('game').style.display = 'none';
      score = 0;
      currentRound = 0;
    }

    function startGame() {
      const roundSelect = document.getElementById('roundsSelect');
      const difficultySelect = document.getElementById('difficultySelect');
      roundCount = parseInt(roundSelect.value, 10) || 5;
      const difficulty = difficultySelect.value;
      score = 0;
      currentRound = 0;

      allScreenshots = generateScreenshots(difficulty, roundCount);

      document.getElementById('landing').style.display = 'none';
      document.getElementById('game').style.display = 'flex';
      document.getElementById('endScreen').style.display = 'none';

      updateStats();
      loadScreenshot();
    }

    function loadScreenshot() {
      if (currentRound >= roundCount) return endGame();
      current = allScreenshots[currentRound];
      currentRound++;
      const img = document.getElementById('screenshot');
      img.style.opacity = 0;
      img.onload = () => img.style.opacity = 1;
      img.src = current.src;
      document.getElementById('result').textContent = '';
      document.getElementById('mapSelect').value = '';
      updateStats();
    }

    function updateStats() {
      if (!document.getElementById('roundInfo')) {
        const stats = document.getElementById('stats');
        stats.innerHTML = `<p id="roundInfo"></p><p id="scoreInfo"></p>`;
      }
      document.getElementById('roundInfo').textContent = `Round ${currentRound} of ${roundCount}`;
      document.getElementById('scoreInfo').textContent = `Points: ${score}`;
    }

    function checkAnswer() {
      const guess = document.getElementById('mapSelect').value;
      if (!guess) return;
      const result = document.getElementById('result');
      const feedback = document.getElementById('gameFeedback');
      const game = document.getElementById('game');
      feedback.style.display = 'block';
      if (guess.toLowerCase() === current.answer.toLowerCase()) {
        score++;
        result.textContent = "Correct! ðŸŽ¯";
        result.style.color = 'green';
        game.style.backgroundColor = 'rgba(0, 255, 0, 0.2)';
      } else {
        result.textContent = `Wrong! It was ${current.answer}.`;
        result.style.color = 'red';
        game.style.backgroundColor = 'rgba(255, 0, 0, 0.2)';
      }
      updateStats();
      setTimeout(() => {
        feedback.style.display = 'none';
        game.style.backgroundColor = '';
        loadScreenshot();
      }, 1500);
    }

    function endGame() {
      document.getElementById('game').style.display = 'none';
      document.getElementById('endScreen').style.display = 'block';
      document.getElementById('finalScore').textContent = `You scored ${score} out of ${roundCount}!`;
    }
  </script>
</body>
</html>
